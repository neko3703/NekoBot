<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Support Me</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link
      rel="shortcut icon"
      href="./images/nekocode.jpg"
      type="image/png"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        background: linear-gradient(135deg, #4a00e0 0%, #8e2de2 100%);
        color: #fff;
        margin: 0;
        padding: 20px;
        box-sizing: border-box;
        overflow: auto;
      }

      .main-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 40px;
        width: 100%;
        max-width: 960px;
        box-sizing: border-box;
      }

      .container {
        background: rgba(255, 255, 255, 0.1);
        padding: 40px;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        text-align: center;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        width: 100%;
        max-width: 450px;
        box-sizing: border-box;
        animation: fadeIn 0.8s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      h2 {
        margin-bottom: 30px;
        font-size: 2.2em;
        font-weight: 700;
        text-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        letter-spacing: 0.5px;
      }

      input, select {
        width: calc(100% - 30px);
        padding: 18px;
        margin-bottom: 25px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        outline: none;
        font-size: 19px;
        box-sizing: border-box;
        background: rgba(255, 255, 255, 0.08);
        color: #fff;
        transition: border-color 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-image: url('data:image/svg+xml;utf8,<svg fill="%23ffffff" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
        background-repeat: no-repeat;
        background-position: right 15px center;
        background-size: 20px;
      }

      input::placeholder {
        color: rgba(255, 255, 255, 0.6);
      }

      input:focus, select:focus {
        border-color: #ffcc00;
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 0 0 3px rgba(255, 204, 0, 0.3);
      }

      button {
        padding: 16px 35px;
        color: #fff;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-size: 19px;
        font-weight: 600;
        transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        margin: 10px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        letter-spacing: 0.5px;
      }

      button:not(.quick-pay-button) {
        background: linear-gradient(45deg, #ff6b6b, #ee4c7c);
      }

      button:not(.quick-pay-button):hover {
        background: linear-gradient(45deg, #ee4c7c, #ff6b6b);
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
      }

      #qrcode-section {
        background: rgba(255, 255, 255, 0.1);
        padding: 30px;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(47, 209, 254, 0.4);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-width: 280px;
        min-height: 280px;
        animation: fadeIn 0.8s ease-out;
        position: relative;
      }

      #qrcode-section p {
        color: rgba(255, 255, 255, 0.8);
        font-size: 1.1em;
        margin-bottom: 20px;
        font-weight: 600;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      #qrcode-canvas-container {
        padding: 15px;
        background: rgba(255, 255, 255, 0.1); /* Matched with main container background */
        border-radius: 10px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4); /* Matched with main container shadow */
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #qrcode-canvas-container canvas {
        border-radius: 8px;
        display: block;
      }

      #qrcode-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        z-index: 10;
        background-color: #FFFFFF;
        padding: 5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        display: none;
      }

      .button-group {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 25px;
        gap: 15px;
      }

      .quick-pay-button {
        flex: 1 1 auto;
        max-width: 130px;
        padding: 14px 20px;
        font-size: 17px;
        background: linear-gradient(45deg, #1abc9c, #16a085);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .quick-pay-button:hover {
        background: linear-gradient(45deg, #16a085, #1abc9c);
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      #amount-in-inr-display {
        margin-top: -15px;
        margin-bottom: 20px;
        font-size: 1.1em;
        font-weight: 600;
        color: #ffcc00;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      @media (max-width: 768px) {
        .container {
          padding: 30px;
        }
        h2 {
          font-size: 2em;
        }
        input, select {
          padding: 15px;
          font-size: 17px;
        }
        button {
          padding: 14px 30px;
          font-size: 17px;
          margin: 8px;
        }
        .mobile-only {
          display: inline-block;
        }
        .desktop-only-button {
          display: none;
        }
        .quick-pay-button {
          flex: 1 1 calc(50% - 15px);
          max-width: unset;
        }
        #qrcode-section {
          margin-top: 40px;
        }
        #qrcode-icon {
          width: 50px;
          height: 50px;
        }
      }

      @media (min-width: 769px) {
        .main-wrapper {
          flex-direction: row;
          justify-content: center;
          align-items: flex-start;
        }
        .container {
          flex: 1;
          max-width: 450px;
        }
        #qrcode-section {
          display: flex;
          flex: 1;
          max-width: 350px;
          height: auto;
          align-self: center;
        }
        .mobile-only {
          display: none;
        }
        .desktop-only-button {
          display: inline-block;
        }
        .button-group.quick-pay-group {
          flex-wrap: nowrap;
          justify-content: center;
          max-width: 480px;
          margin-left: auto;
          margin-right: auto;
          gap: 8px;
        }
        .quick-pay-button {
          flex-shrink: 0;
          flex-grow: 0;
          width: auto;
          min-width: 100px;
        }
      }
    </style>
  </head>
  <body>
    <div class="main-wrapper">
      <div class="container">
        <h2>Support My Work ✨</h2>
        <input
          type="number"
          id="amount"
          placeholder="Enter amount"
          oninput="updateURL(); convertAmountForPayment();"
        />

        <select id="currency-select" onchange="convertAmountForPayment()">
            <option value="INR">INR - Indian Rupee</option>
            <option value="USD">USD - US Dollar</option>
            <option value="EUR">EUR - Euro</option>
        </select>

        <div id="amount-in-inr-display"></div>

        <div class="button-group">
          <button onclick="generateQRCode()" class="desktop-only-button">Pay Using QR</button>
          <button class="mobile-only" onclick="upiPay()">Pay Directly</button>
        </div>

        <div class="button-group quick-pay-group">
          <button class="quick-pay-button" data-amount="300" data-currency="INR" onclick="handleQuickPay(this.dataset.amount, this.dataset.currency)">₹300</button>
          <button class="quick-pay-button" data-amount="500" data-currency="INR" onclick="handleQuickPay(this.dataset.amount, this.dataset.currency)">₹500</button>
          <button class="quick-pay-button" data-amount="1000" data-currency="INR" onclick="handleQuickPay(this.dataset.amount, this.dataset.currency)">₹1000</button>
        </div>
      </div>

      <div id="qrcode-section">
        <p>Scan to Pay</p>
        <div id="qrcode-canvas-container">
            <img id="qrcode-icon" src="./images/nekocode.jpg" alt="Icon">
        </div>
      </div>
    </div>

    <script>
      const EXCHANGE_RATES = {
        "USD_TO_INR": 83.50,
        "EUR_TO_INR": 90.00,
      };

      function getQueryParam(name) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(name);
      }

      function updateURL() {
        const amountInput = document.getElementById("amount");
        const url = new URL(window.location);
        if (
          amountInput.value.trim() !== "" &&
          !isNaN(amountInput.value) &&
          parseFloat(amountInput.value) > 0
        ) {
          url.searchParams.set("amount", amountInput.value);
        } else {
          url.searchParams.delete("amount");
        }
        window.history.replaceState(null, "", url.toString());
      }

      function convertAmountForPayment() {
        const amountInput = document.getElementById("amount");
        const currencySelect = document.getElementById("currency-select");
        const amountInINRDisplay = document.getElementById("amount-in-inr-display");

        const enteredAmount = parseFloat(amountInput.value);
        const selectedCurrency = currencySelect.value;

        if (isNaN(enteredAmount) || enteredAmount <= 0) {
          amountInINRDisplay.textContent = "";
          amountInput.dataset.amountInInr = "";
          return;
        }

        let amountForUPI = 0;

        if (selectedCurrency === "INR") {
          amountForUPI = enteredAmount;
          amountInINRDisplay.textContent = "";
        } else if (selectedCurrency === "USD") {
          amountForUPI = enteredAmount * EXCHANGE_RATES.USD_TO_INR;
          amountInINRDisplay.textContent = `(Approx. ₹${amountForUPI.toFixed(2)})`;
        } else if (selectedCurrency === "EUR") {
          amountForUPI = enteredAmount * EXCHANGE_RATES.EUR_TO_INR;
          amountInINRDisplay.textContent = `(Approx. ₹${amountForUPI.toFixed(2)})`;
        }

        amountInput.dataset.amountInInr = amountForUPI.toFixed(2);
      }

      function generateQRCode() {
        const amountInput = document.getElementById("amount");
        const qrCodeSectionDiv = document.getElementById("qrcode-section");
        const qrCodeCanvasContainer = document.getElementById("qrcode-canvas-container");
        const qrCodeIcon = document.getElementById("qrcode-icon");

        qrCodeCanvasContainer.innerHTML = "";
        qrCodeCanvasContainer.appendChild(qrCodeIcon);
        qrCodeIcon.style.display = "none";

        const amountForPayment = parseFloat(amountInput.dataset.amountInInr);

        if (isNaN(amountForPayment) || amountForPayment <= 0) {
          qrCodeSectionDiv.style.display = "none";
          return;
        }

        const upiId = "neko@barodampay";
        const payeeName = "Neko";
        const payUrl = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(
          payeeName
        )}&am=${amountForPayment.toFixed(2)}&cu=INR`;

        new QRCode(qrCodeCanvasContainer, {
          text: payUrl,
          width: 200,
          height: 200,
          colorDark : "#000000",
          colorLight : "#FFFFFF",
          correctLevel : QRCode.CorrectLevel.H
        });

        qrCodeSectionDiv.style.display = "flex";
        qrCodeIcon.style.display = "block";
      }

      function upiPay() {
        const amountInput = document.getElementById("amount");
        const qrCodeSectionDiv = document.getElementById("qrcode-section");
        const qrCodeIcon = document.getElementById("qrcode-icon");

        qrCodeSectionDiv.style.display = "none";
        qrCodeIcon.style.display = "none";

        const amountForPayment = parseFloat(amountInput.dataset.amountInInr);

        if (isNaN(amountForPayment) || amountForPayment <= 0) {
          return;
        }

        const upiId = "neko@barodampay";
        const payeeName = "Neko";
        const payUrl = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(payeeName)}&am=${amountForPayment.toFixed(2)}&cu=INR`;

        window.location.href = payUrl;
      }

      function handleQuickPay(amount, currency) {
        document.getElementById("amount").value = amount;
        document.getElementById("currency-select").value = currency;
        updateURL();
        convertAmountForPayment();

        if (window.innerWidth <= 768) {
          upiPay();
        } else {
          generateQRCode();
        }
      }

      window.onload = function () {
        const amountParam = getQueryParam("amount");
        if (amountParam) {
          document.getElementById("amount").value = amountParam;
          document.getElementById('currency-select').value = getQueryParam("currency") || 'INR';
          updateURL();
          convertAmountForPayment();
          if (window.innerWidth <= 768) {
            generateQRCode();
          } else {
            generateQRCode();
          }
        } else {
            document.getElementById('currency-select').value = 'INR';
            document.getElementById("amount-in-inr-display").textContent = "";
        }
      };
    </script>
  </body>
</html>
